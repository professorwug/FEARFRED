<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>FEARFRED - Toy Graph Datasets for FRED</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="FEARFRED - Toy Graph Datasets for FRED">
<meta property="og:description" content="FRED is, at heart, an embedder of directed graphs. But what types of graphs? This notebook, and those nested under 01a01, contain a battery of toy directed graphs, including:">
<meta property="og:site-name" content="FEARFRED">
<meta name="twitter:title" content="FEARFRED - Toy Graph Datasets for FRED">
<meta name="twitter:description" content="FRED is, at heart, an embedder of directed graphs. But what types of graphs? This notebook, and those nested under 01a01, contain a battery of toy directed graphs, including:">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">FEARFRED</span>
  </a>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Toy Graph Datasets for FRED</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">FEARFRED</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link">core</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./toy_graph_datasets.html" class="sidebar-item-text sidebar-link active">Toy Graph Datasets for FRED</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#graph-visualization-tools" id="toc-graph-visualization-tools" class="nav-link active" data-scroll-target="#graph-visualization-tools">Graph Visualization Tools</a>
  <ul class="collapse">
  <li><a href="#visualize_graph" id="toc-visualize_graph" class="nav-link" data-scroll-target="#visualize_graph">visualize_graph</a></li>
  <li><a href="#visualize_heatmap" id="toc-visualize_heatmap" class="nav-link" data-scroll-target="#visualize_heatmap">visualize_heatmap</a></li>
  <li><a href="#display_gallery" id="toc-display_gallery" class="nav-link" data-scroll-target="#display_gallery">display_gallery</a></li>
  <li><a href="#display_graph_gallery" id="toc-display_graph_gallery" class="nav-link" data-scroll-target="#display_graph_gallery">display_graph_gallery</a></li>
  <li><a href="#display_heatmap_gallery" id="toc-display_heatmap_gallery" class="nav-link" data-scroll-target="#display_heatmap_gallery">display_heatmap_gallery</a></li>
  </ul></li>
  <li><a href="#small-random-toy-directed-graphs" id="toc-small-random-toy-directed-graphs" class="nav-link" data-scroll-target="#small-random-toy-directed-graphs">Small Random Toy Directed Graphs</a>
  <ul class="collapse">
  <li><a href="#smallrandom" id="toc-smallrandom" class="nav-link" data-scroll-target="#smallrandom">SmallRandom</a></li>
  <li><a href="#add-source-and-sink-communities" id="toc-add-source-and-sink-communities" class="nav-link" data-scroll-target="#add-source-and-sink-communities">Add source and sink communities</a>
  <ul class="collapse">
  <li><a href="#sourcesink" id="toc-sourcesink" class="nav-link" data-scroll-target="#sourcesink">SourceSink</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#specific-small-graphs" id="toc-specific-small-graphs" class="nav-link" data-scroll-target="#specific-small-graphs">Specific Small Graphs</a>
  <ul class="collapse">
  <li><a href="#chaingraph" id="toc-chaingraph" class="nav-link" data-scroll-target="#chaingraph">ChainGraph</a></li>
  <li><a href="#halfchaingraph" id="toc-halfchaingraph" class="nav-link" data-scroll-target="#halfchaingraph">HalfChainGraph</a></li>
  <li><a href="#cyclegraph" id="toc-cyclegraph" class="nav-link" data-scroll-target="#cyclegraph">CycleGraph</a></li>
  <li><a href="#halfcyclegraph" id="toc-halfcyclegraph" class="nav-link" data-scroll-target="#halfcyclegraph">HalfCycleGraph</a></li>
  </ul></li>
  <li><a href="#showcase" id="toc-showcase" class="nav-link" data-scroll-target="#showcase">Showcase</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/professorwug/FEARFRED/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Toy Graph Datasets for FRED</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>FRED is, at heart, an embedder of directed graphs. But what types of graphs? This notebook, and those nested under 01a01, contain a battery of toy directed graphs, including:</p>
<ol type="1">
<li>(Directed) Stochastic Block Models</li>
<li>Trees</li>
<li>Small Random graphs</li>
</ol>
<p>This notebook houses a sampling of these graphs, with details on how to call them and visualize them.</p>
<section id="graph-visualization-tools" class="level2">
<h2 class="anchored" data-anchor-id="graph-visualization-tools">Graph Visualization Tools</h2>
<hr>
<section id="visualize_graph" class="level3">
<h3 class="anchored" data-anchor-id="visualize_graph">visualize_graph</h3>
<blockquote class="blockquote">
<pre><code> visualize_graph (data, is_networkx=False, to_undirected=False, ax=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L9" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="visualize_heatmap" class="level3">
<h3 class="anchored" data-anchor-id="visualize_heatmap">visualize_heatmap</h3>
<blockquote class="blockquote">
<pre><code> visualize_heatmap (edge_index, order_ind=None, cmap='copper', ax=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L20" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="display_gallery" class="level3">
<h3 class="anchored" data-anchor-id="display_gallery">display_gallery</h3>
<blockquote class="blockquote">
<pre><code> display_gallery (vizset, ncol=4)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L31" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="display_graph_gallery" class="level3">
<h3 class="anchored" data-anchor-id="display_graph_gallery">display_graph_gallery</h3>
<blockquote class="blockquote">
<pre><code> display_graph_gallery (dataset, ncol=4)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L38" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="display_heatmap_gallery" class="level3">
<h3 class="anchored" data-anchor-id="display_heatmap_gallery">display_heatmap_gallery</h3>
<blockquote class="blockquote">
<pre><code> display_heatmap_gallery (dataset, ncol=4)</code></pre>
</blockquote>
</section>
</section>
<section id="small-random-toy-directed-graphs" class="level1">
<h1>Small Random Toy Directed Graphs</h1>
<p>First, we will create several small and random toy directed graphs and visualize them directly. We will test any embedding and visualization methods on these datasets to check if the embeddings/visualization matches our intuition about the flow on the small directed graphs.</p>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L55" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="smallrandom" class="level3">
<h3 class="anchored" data-anchor-id="smallrandom">SmallRandom</h3>
<blockquote class="blockquote">
<pre><code> SmallRandom (num_nodes=5, prob_edge=0.2, transform=None,
              pre_transform=None)</code></pre>
</blockquote>
<p>Dataset base class for creating graph datasets which easily fit into CPU memory. Inherits from :class:<code>torch_geometric.data.Dataset</code>. See <code>here &lt;https://pytorch-geometric.readthedocs.io/en/latest/notes/ create_dataset.html#creating-in-memory-datasets&gt;</code>__ for the accompanying tutorial.</p>
<p>Args: root (string, optional): Root directory where the dataset should be saved. (default: :obj:<code>None</code>) transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before every access. (default: :obj:<code>None</code>) pre_transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before being saved to disk. (default: :obj:<code>None</code>) pre_filter (callable, optional): A function that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a boolean value, indicating whether the data object should be included in the final dataset. (default: :obj:<code>None</code>)</p>
<p>Let’s try creating one such graph</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> SmallRandom(num_nodes<span class="op">=</span><span class="dv">10</span>, prob_edge<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dataset[<span class="dv">0</span>] <span class="co"># there is only graph in this dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>visualize_graph(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-9-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="add-source-and-sink-communities" class="level2">
<h2 class="anchored" data-anchor-id="add-source-and-sink-communities">Add source and sink communities</h2>
<p>In a directed graph, a node is a source if it has in-degree of 0, and a node is a sink if it has out-degree of 0. These notions can be generalized into source communities and sink communities (by communities we simply mean a group of nodes in the directed graph). If we think of information on the directed graph as some mass diffusing through random walk, then mass will stay in the sink communities once enter and mass will stay out of the source communities once exit. Then, the existence of source and/or sink communities could imbalancedly affect the measurement of diffusion curvature.</p>
<p>In order to assess and possibly correct this effect, we first want to create directed graphs with source and/or sink communities. We will do so by create pretransformation to existing directed graph data so to make all edges connected to some ground-truth communities pointing outwards (for source communities) or inwards (for sink communities).</p>
<p>We will be flexible and add a parameter <code>adv_prob</code> to indicate the probability of edges pointing in the <em>wrong</em> direction. This probability should be zero or close to zero.</p>
<p>There are two possible way to <em>correct</em> the edges that point in the wrong direction: either by reversing the direction or by removing the edge completely. The probability of employing these methods is specified by the probability <code>remove_prob</code>. This parameter could help mitigate the effect of excessive number of edges pointing out of (into resp.) source (sink resp.) communities.</p>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L82" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="sourcesink" class="level3">
<h3 class="anchored" data-anchor-id="sourcesink">SourceSink</h3>
<blockquote class="blockquote">
<pre><code> SourceSink (prob_source=0.1, prob_sink=0.1, adv_prob=0, remove_prob=0)</code></pre>
</blockquote>
<p>Transform a (directed or undirected) graph into a directed graph with a proportion of the nodes with mostly out-edges and a porportion of the nodes with mostly in-edges</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>prob_source</td>
<td>float</td>
<td>0.1</td>
<td>must be between 0 and 1<br>Proportion of nodes/communities to turn into source nodes/communities<br>(with mostly out-edges)</td>
</tr>
<tr class="even">
<td>prob_sink</td>
<td>float</td>
<td>0.1</td>
<td>must be between 0 and 1<br>prob_source and prob_sink must add up to no more than 1<br>Proportion of nodes/communities to turn into sink nodes/communities<br>(with mostly in-edges)</td>
</tr>
<tr class="odd">
<td>adv_prob</td>
<td>int</td>
<td>0</td>
<td>must be between 0 and 1<br>Probability of in-edges for source nodes and/or out-edges for sink nodes</td>
</tr>
<tr class="even">
<td>remove_prob</td>
<td>int</td>
<td>0</td>
<td>must be between 0 and 1<br>Probability of removing an in-edge for source nodes and/or out-edges for sink nodes<br>1 - remove_prob is the probability of reversing the direction of in-edge for source nodes and/or out-edges for sink nodes</td>
</tr>
</tbody>
</table>
<p>It is also possible to create source and sink nodes using the same <a href="https://professorwug.github.io/FEARFRED/graph_datasets.html#sourcesink"><code>SourceSink</code></a> transformation to generate small directed graph with specific characteristic. We will try transforming the graph above into a big cluster of source and a smaller cluster of sinks</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pre_transform <span class="op">=</span> SourceSink(prob_source<span class="op">=</span><span class="fl">0.6</span>, prob_sink<span class="op">=</span><span class="fl">0.4</span>, adv_prob<span class="op">=</span><span class="fl">0.1</span>, remove_prob<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> SmallRandom(num_nodes<span class="op">=</span><span class="dv">20</span>, prob_edge<span class="op">=</span><span class="fl">0.2</span>, pre_transform<span class="op">=</span>pre_transform)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dataset[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/y5/4qfj8yjj1hb97n6q01_dg0km0000gn/T/ipykernel_88073/2928479379.py:88: UserWarning: Data has no ground-truth labels
  warnings.warn("Data has no ground-truth labels")</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>visualize_graph(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-12-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>order_ind <span class="op">=</span> torch.argsort(data.y[:,<span class="dv">1</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>visualize_heatmap(data.edge_index, order_ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-13-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="specific-small-graphs" class="level1">
<h1>Specific Small Graphs</h1>
<p>We create a few extremely simple graphs that can be immediately understood with simple nodes-and-edges visualization, including <a href="https://professorwug.github.io/FEARFRED/graph_datasets.html#chaingraph"><code>ChainGraph</code></a> and <a href="https://professorwug.github.io/FEARFRED/graph_datasets.html#cyclegraph"><code>CycleGraph</code></a>.</p>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L200" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="chaingraph" class="level3">
<h3 class="anchored" data-anchor-id="chaingraph">ChainGraph</h3>
<blockquote class="blockquote">
<pre><code> ChainGraph (num_nodes=5, transform=None)</code></pre>
</blockquote>
<p>Dataset base class for creating graph datasets which easily fit into CPU memory. Inherits from :class:<code>torch_geometric.data.Dataset</code>. See <code>here &lt;https://pytorch-geometric.readthedocs.io/en/latest/notes/ create_dataset.html#creating-in-memory-datasets&gt;</code>__ for the accompanying tutorial.</p>
<p>Args: root (string, optional): Root directory where the dataset should be saved. (default: :obj:<code>None</code>) transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before every access. (default: :obj:<code>None</code>) pre_transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before being saved to disk. (default: :obj:<code>None</code>) pre_filter (callable, optional): A function that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a boolean value, indicating whether the data object should be included in the final dataset. (default: :obj:<code>None</code>)</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> ChainGraph(num_nodes<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dataset[<span class="dv">0</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>visualize_graph(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-15-output-1.svg" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L213" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="halfchaingraph" class="level3">
<h3 class="anchored" data-anchor-id="halfchaingraph">HalfChainGraph</h3>
<blockquote class="blockquote">
<pre><code> HalfChainGraph (num_nodes=3, center=1, transform=None)</code></pre>
</blockquote>
<p>Dataset base class for creating graph datasets which easily fit into CPU memory. Inherits from :class:<code>torch_geometric.data.Dataset</code>. See <code>here &lt;https://pytorch-geometric.readthedocs.io/en/latest/notes/ create_dataset.html#creating-in-memory-datasets&gt;</code>__ for the accompanying tutorial.</p>
<p>Args: root (string, optional): Root directory where the dataset should be saved. (default: :obj:<code>None</code>) transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before every access. (default: :obj:<code>None</code>) pre_transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before being saved to disk. (default: :obj:<code>None</code>) pre_filter (callable, optional): A function that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a boolean value, indicating whether the data object should be included in the final dataset. (default: :obj:<code>None</code>)</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> HalfChainGraph(num_nodes<span class="op">=</span><span class="dv">6</span>, center<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dataset[<span class="dv">0</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>visualize_graph(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-17-output-1.svg" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L229" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cyclegraph" class="level3">
<h3 class="anchored" data-anchor-id="cyclegraph">CycleGraph</h3>
<blockquote class="blockquote">
<pre><code> CycleGraph (num_nodes=8, transform=None)</code></pre>
</blockquote>
<p>Dataset base class for creating graph datasets which easily fit into CPU memory. Inherits from :class:<code>torch_geometric.data.Dataset</code>. See <code>here &lt;https://pytorch-geometric.readthedocs.io/en/latest/notes/ create_dataset.html#creating-in-memory-datasets&gt;</code>__ for the accompanying tutorial.</p>
<p>Args: root (string, optional): Root directory where the dataset should be saved. (default: :obj:<code>None</code>) transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before every access. (default: :obj:<code>None</code>) pre_transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before being saved to disk. (default: :obj:<code>None</code>) pre_filter (callable, optional): A function that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a boolean value, indicating whether the data object should be included in the final dataset. (default: :obj:<code>None</code>)</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> CycleGraph(num_nodes<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dataset[<span class="dv">0</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>visualize_graph(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-19-output-1.svg" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/professorwug/FEARFRED/blob/main/FEARFRED/datasets/toy_graphs.py#L243" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="halfcyclegraph" class="level3">
<h3 class="anchored" data-anchor-id="halfcyclegraph">HalfCycleGraph</h3>
<blockquote class="blockquote">
<pre><code> HalfCycleGraph (num_nodes=3, center=0, transform=None)</code></pre>
</blockquote>
<p>Dataset base class for creating graph datasets which easily fit into CPU memory. Inherits from :class:<code>torch_geometric.data.Dataset</code>. See <code>here &lt;https://pytorch-geometric.readthedocs.io/en/latest/notes/ create_dataset.html#creating-in-memory-datasets&gt;</code>__ for the accompanying tutorial.</p>
<p>Args: root (string, optional): Root directory where the dataset should be saved. (default: :obj:<code>None</code>) transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before every access. (default: :obj:<code>None</code>) pre_transform (callable, optional): A function/transform that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a transformed version. The data object will be transformed before being saved to disk. (default: :obj:<code>None</code>) pre_filter (callable, optional): A function that takes in an :obj:<code>torch_geometric.data.Data</code> object and returns a boolean value, indicating whether the data object should be included in the final dataset. (default: :obj:<code>None</code>)</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> HalfCycleGraph(num_nodes<span class="op">=</span><span class="dv">8</span>, center<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dataset[<span class="dv">0</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>visualize_graph(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-21-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="showcase" class="level1">
<h1>Showcase</h1>
<div class="cell" data-execution_count="25">
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/y5/4qfj8yjj1hb97n6q01_dg0km0000gn/T/ipykernel_88073/2928479379.py:88: UserWarning: Data has no ground-truth labels
  warnings.warn("Data has no ground-truth labels")</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="01a_Toy_Graph_Datasets_files/figure-html/cell-22-output-2.svg" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>